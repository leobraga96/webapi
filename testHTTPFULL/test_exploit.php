<?php include_once ("httpful.phar");

	function testGetExploit() {
		$uri = "http://localhost/RP/index.php/exploit/?idexploit=024577";
		$response = \Httpful\Request::get($uri)->send();
		echo $response;
	}

	function testExploitInsertValido() {
	$uri = 'http://localhost/RP/index.php/exploit/';
	$response = \Httpful\Request::post($uri)
	->sendsJson()->body(
		'{			"idexploit": "024577",
					"porta": "8080", 
					"desc": "Apache 2.0.44 (Linux) - Remote Denial of Service",
					"type": "dos",
					"file":"platforms/linux/dos/11.c",
					"plataforma": "linux"
		}')
	->send();
	return strcmp($response->body, 'testExploitInsertValido -> {"200":"Ok"}') == 0;
	echo __FUNCTION__ . " " . "Teste Funcionou";
	}

function testExploitInsertBodyinvalido() {
	$uri = 'http://localhost/RP/index.php/exploit/';
	$response = \Httpful\Request::post($uri)
	->sendsJson()->body(
		'{			"exploit": "024577",
					"porta": "8080", 
					"desc": "Apache 2.0.44 (Linux) - Remote Denial of Service",
					"type": "dos",
					"file":"platforms/linux/dos/11.c",
					"plataforma": "linux"
		}')
	->send();
	return strcmp($response->body, 'testExploitInsertBodyinvalido -> {"400": "Bad Request"}') == 0;
	echo __FUNCTION__ . " " . "Teste Funcionou";
	}

function testExploitInsertIdexploitInvalido() {
	$uri = 'http://localhost/RP/index.php/exploit/';
	$response = \Httpful\Request::post($uri)
	->sendsJson()->body(
		'{			"idexploit": "abc",
					"porta": "8080", 
					"desc": "Apache 2.0.44 (Linux) - Remote Denial of Service",
					"type": "dos",
					"file":"platforms/linux/dos/11.c",
					"plataforma": "linux"
		}')
	->send();
	return strcmp($response->body, 'testExploitInsertIdexploitInvalido -> {"400": "Bad Request"}') == 0;
	echo __FUNCTION__ . " " . "Teste Funcionou";
	
	}

function testExploitInsertPortaValida() {
	$uri = 'http://localhost/RP/index.php/exploit/';
	$response = \Httpful\Request::post($uri)
	->sendsJson()->body(
		'{			"idexploit": "024577",
					"porta": "abc", 
					"desc": "Apache 2.0.44 (Linux) - Remote Denial of Service",
					"type": "dos",
					"file":"platforms/linux/dos/11.c",
					"plataforma": "linux"
		}')
	->send();
	return strcmp($response->body, 'testExploitInsertPortaValida -> {"400": "Bad Request"}') == 0;
	echo __FUNCTION__ . " " . "Teste Funcionou";
	}

function testExploitInsertDescricaoInvalida() {
	$uri = 'http://localhost/RP/index.php/exploit/';
	$response = \Httpful\Request::post($uri)
	->sendsJson()->body(
		'{			"idexploit": "024577",
					"porta": "8080", 
					"desc": "Blue",
					"type": "dos",
					"file":"platforms/linux/dos/11.c",
					"plataforma": "linux"
		}')
	->send();
	return strcmp($response->body, 'testExploitInsertValido -> {"400": "Bad Request"}') == 0;
	echo __FUNCTION__ . " " . "Teste Funcionou";
	}

function testExploitInsertTypeInvalido() {
	$uri = 'http://localhost/RP/index.php/exploit/';
	$response = \Httpful\Request::post($uri)
	->sendsJson()->body(
		'{			"idexploit": "024577",
					"porta": "8080", 
					"desc": "Apache 2.0.44 (Linux) - Remote Denial of Service",
					"type": "001",
					"file":"platforms/linux/dos/11.c",
					"plataforma": "linux"
		}')
	->send();
	return strcmp($response->body, 'testExploitInsertTypeInvalido -> {"400": "Bad Request"}') == 0;
	echo __FUNCTION__ . " " . "Teste Funcionou";
	}
